{"changed":true,"filter":false,"title":"index.js","tooltip":"/lambda/index.js","value":"var\n    AWS_SDK = require(\"aws-sdk\"),\n    S3_API = new AWS_SDK.S3({apiVersion: \"2006-03-01\"}),\n    MYSQL = require(\"mysql2\");\n    \nexports.handler = function(event, context, callback){\n    var mysql = MYSQL.createConnection({\n          host: 'supplierdb.cluster-cpxppksqovzb.us-east-1.rds.amazonaws.com',\n          password: 'coffee',\n          user: 'nodeapp',\n          database: 'COFFEE'\n        });\n    mysql.query('SELECT * from suppliers',function(err, results) {\n        if(err){\n            return callback(err, null);\n        }\n        var suppliers = results;\n        mysql.query('SELECT * from beans',function(err, results) {\n            if(err){\n                return callback(err, null);\n            }\n            var beans = results;\n            mysql.close();\n            mergeData(suppliers, beans, callback);\n        });\n    });\n  function mergeData(suppliers_arr, beans_arr, callback){\n    var fine_tunes_data_arr = [];\n    for(var i_int = 0; i_int < suppliers_arr.length; i_int += 1){\n      var o = {};\n      console.log(suppliers_arr[i_int].name);\n      o.suppliers_id_int = suppliers_arr[i_int].id;\n      o.supplier_name_str = suppliers_arr[i_int].name;\n      o.supplier_address_str = suppliers_arr[i_int].address;\n      o.supplier_phone_str = suppliers_arr[i_int].phone;\n      o.bean_info_obj_arr = [];\n      for(var j_int = 0; j_int < beans_arr.length; j_int += 1){\n        if(suppliers_arr[i_int].id === beans_arr[j_int].supplier_id){\n          var b = {\n            type_str: beans_arr[j_int].type,\n            product_name_str: beans_arr[j_int].product_name,\n            quantity_int: beans_arr[j_int].quantity\n          };\n          o.bean_info_obj_arr.push(b);\n        }\n      }\n      fine_tunes_data_arr.push(o);\n    }\n    callback(null, {\n      my_json_arr: fine_tunes_data_arr\n    });\n  }\n};","undoManager":{"mark":2,"position":3,"stack":[[{"start":{"row":0,"column":0},"end":{"row":51,"column":2},"action":"insert","lines":["var","    AWS_SDK = require(\"aws-sdk\"),","    S3_API = new AWS_SDK.S3({apiVersion: \"2006-03-01\"}),","    MYSQL = require(\"mysql2\");","exports.handler = function(event, context, callback){","    var mysql = MYSQL.createConnection({","          host: 'DB-ENDPOINT',","          password: 'coffee',","          user: 'nodeapp',","          database: 'COFFEE'","        });","    mysql.query('SELECT * from suppliers',function(err, results) {","        if(err){","            return callback(err, null);","        }","        var suppliers = results;","        mysql.query('SELECT * from beans',function(err, results) {","            if(err){","                return callback(err, null);","            }","            var beans = results;","            mysql.close();","            mergeData(suppliers, beans, callback);","        });","    });","  function mergeData(suppliers_arr, beans_arr, callback){","    var fine_tunes_data_arr = [];","    for(var i_int = 0; i_int < suppliers_arr.length; i_int += 1){","      var o = {};","      console.log(suppliers_arr[i_int].name);","      o.suppliers_id_int = suppliers_arr[i_int].id;","      o.supplier_name_str = suppliers_arr[i_int].name;","      o.supplier_address_str = suppliers_arr[i_int].address;","      o.supplier_phone_str = suppliers_arr[i_int].phone;","      o.bean_info_obj_arr = [];","      for(var j_int = 0; j_int < beans_arr.length; j_int += 1){","        if(suppliers_arr[i_int].id === beans_arr[j_int].supplier_id){","          var b = {","            type_str: beans_arr[j_int].type,","            product_name_str: beans_arr[j_int].product_name,","            quantity_int: beans_arr[j_int].quantity","          };","          o.bean_info_obj_arr.push(b);","        }","      }","      fine_tunes_data_arr.push(o);","    }","    callback(null, {","      my_json_arr: fine_tunes_data_arr","    });","  }","};"],"id":1}],[{"start":{"row":6,"column":27},"end":{"row":6,"column":28},"action":"remove","lines":["T"],"id":2},{"start":{"row":6,"column":26},"end":{"row":6,"column":27},"action":"remove","lines":["N"]},{"start":{"row":6,"column":25},"end":{"row":6,"column":26},"action":"remove","lines":["I"]},{"start":{"row":6,"column":24},"end":{"row":6,"column":25},"action":"remove","lines":["O"]},{"start":{"row":6,"column":23},"end":{"row":6,"column":24},"action":"remove","lines":["P"]},{"start":{"row":6,"column":22},"end":{"row":6,"column":23},"action":"remove","lines":["D"]},{"start":{"row":6,"column":21},"end":{"row":6,"column":22},"action":"remove","lines":["N"]},{"start":{"row":6,"column":20},"end":{"row":6,"column":21},"action":"remove","lines":["E"]},{"start":{"row":6,"column":19},"end":{"row":6,"column":20},"action":"remove","lines":["-"]},{"start":{"row":6,"column":18},"end":{"row":6,"column":19},"action":"remove","lines":["B"]},{"start":{"row":6,"column":17},"end":{"row":6,"column":18},"action":"remove","lines":["D"]}],[{"start":{"row":6,"column":17},"end":{"row":6,"column":76},"action":"insert","lines":["supplierdb.cluster-cpxppksqovzb.us-east-1.rds.amazonaws.com"],"id":3}],[{"start":{"row":3,"column":30},"end":{"row":4,"column":0},"action":"insert","lines":["",""],"id":4},{"start":{"row":4,"column":0},"end":{"row":4,"column":4},"action":"insert","lines":["    "]}]]},"ace":{"folds":[],"scrolltop":0,"scrollleft":0,"selection":{"start":{"row":4,"column":4},"end":{"row":4,"column":4},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1696229453016}